(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{8160:function(e,t,a){Promise.resolve().then(a.bind(a,3266))},8064:function(e,t,a){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return r}});let s=a(4590);function r(e){let{createServerReference:t}=a(6671);return t(e,s.callServer)}},2883:function(e,t,a){"use strict";a.d(t,{DB:function(){return r},R3:function(){return n},kS:function(){return i}}),a(4590);var s=a(8064),r=(0,s.$)("5486d838e231cf24590dc082711d152869fd7c5c"),n=(0,s.$)("6b193b7dd760480fa99649ba05b660599c222054"),i=(0,s.$)("713eaaa097ec6c7d33b98ec92fce594723ea9738")},3266:function(e,t,a){"use strict";var s=a(7437),r=a(2265),n=a(6463),i=a(8472),l=a(8132),o=a(3772),c=a(2883);t.default=e=>{let{session:t}=e,a=(0,n.useRouter)(),[u,d]=(0,r.useState)(1),[p,f]=(0,r.useState)(""),[h,b]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[x,w]=(0,r.useState)(""),[y,v]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(null==t?void 0:t.isAuth)&&(0,n.redirect)("/profile")},[]);let j=async()=>{if(1===u){let e=(0,l.O)("phone",p);if(e){w(e);return}w("");try{let e=await o.e.post("/user_profile/user_exist/",{user_id:p});e.data.user_exist?(console.log(e.data),d(2)):w("This mobile number does not exist.")}catch(e){console.log(e),k(e)}}else if(2===u&&""!==h&&""===m)try{let e=await o.e.post("/user_profile/login/",{user_id:p,password:h});200===e.status?(console.log(e.data),await (0,c.R3)(e.data.token,p),a.push("/profile")):w("Login failed. Check your credentials.")}catch(e){w("Failed to login.")}},N=async()=>{let e="".concat("+91").concat(p.replace(/\D/g,""));try{let t=await i.Z.get("https://getotp-co-send-otps-via-whatsapp-globally-for-free.p.rapidapi.com/api",{params:{key:"712bffad4amsh4602e17e5ea28cdp18ccfdjsnd18774d6b93d",otp:m,to:e},headers:{"x-rapidapi-host":"getotp-co-send-otps-via-whatsapp-globally-for-free.p.rapidapi.com","x-rapidapi-key":"712bffad4amsh4602e17e5ea28cdp18ccfdjsnd18774d6b93d"}});200===t.status?(v(!0),d(3)):w("Failed to send OTP via WhatsApp.")}catch(e){w("Error sending OTP. Please try again later.")}},k=e=>{e.response?404===e.response.status?w("This mobile number does not exist."):w("'Server responded with error': ".concat(e.response.status)):e.request?w("No response from the server. Please try again later."):w("Network error. Please check your connection.")};return(0,s.jsx)("div",{className:"flex justify-center items-center h-screen bg-cyan-400",children:(0,s.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md m-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Login"}),1===u&&(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"text",placeholder:"Email or Mobile Number",value:p,onChange:e=>f(e.target.value),className:"bg-gray-100 text-gray-600 w-full p-2 rounded-full outline-none mb-4"}),x&&(0,s.jsx)("p",{className:"text-red-500 text-center mb-4",children:x}),(0,s.jsx)("button",{onClick:j,className:"bg-blue-500 text-white w-full p-2 rounded-full",children:"Next"})]}),2===u&&(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"password",placeholder:"Password",value:h,onChange:e=>b(e.target.value),className:"bg-gray-100 text-gray-600 w-full p-2 rounded-full outline-none mb-4"}),(0,s.jsx)("button",{onClick:j,className:"bg-blue-500 text-white w-full p-2 rounded-full active:bg-secondary",children:"Login"}),(0,s.jsx)("p",{onClick:N,className:"text-blue-500 text-sm mt-4 cursor-pointer text-center",children:"Login with OTP"})]}),3===u&&(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex justify-between mb-4",children:[1,2,3,4].map(e=>(0,s.jsx)("input",{type:"text",maxLength:1,className:"bg-gray-100 text-gray-600 w-12 p-2 text-center rounded-full outline-none",value:m[e-1]||"",onChange:t=>{let a=m.split("");a[e-1]=t.target.value,g(a.join(""))}},e))}),x&&(0,s.jsx)("p",{className:"text-red-500 text-center mb-4",children:x}),(0,s.jsx)("button",{onClick:()=>{4===m.length?a.push("/profile"):w("Invalid OTP. Please try again.")},className:"bg-blue-500 text-white w-full p-2 rounded-full",children:"Verify OTP"})]})]})})}},3772:function(e,t,a){"use strict";a.d(t,{e:function(){return s}});let s=a(8472).Z.create({baseURL:"https://gosang-d9esgjhxbsa0cwav.southindia-01.azurewebsites.net/api",timeout:1e3,headers:{"X-Custom-Header":"Gosang",Authorization:""}})},8132:function(e,t,a){"use strict";a.d(t,{O:function(){return s}});let s=(e,t)=>{let a="";if(t)switch(e){case"email":/\S+@\S+\.\S+/.test(t)||(a="Email is invalid");break;case"first_name":case"last_name":""===t&&(a="Name is required");break;case"DOB":""===t&&(a="DOB is required");break;case"contact_number":""===t.trim()?a="Phone number is required":/^[6-9]\d{9}$/.test(t)||(a="Phone number must be a 10-digit & starting with 6, 7, 8,9")}else a="This field is required";return a}}},function(e){e.O(0,[236,971,23,744],function(){return e(e.s=8160)}),_N_E=e.O()}]);